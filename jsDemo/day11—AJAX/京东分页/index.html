<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>京东分页</title>
		<style>
			*{margin: 0;padding: 0;font-family: "微软雅黑";}
			li{list-style: none;}
			a{text-decoration: none;}
			.header{width: 1200px;height: 53px;margin: 0 auto;}
			#picBox{width: 1200px;margin: 0 auto;}
			#picBox li{width: 240px;height: 440px;float: left;}
			.price{font-size: 15px;color: #e4393c;line-height: 18px;width: 170px;height: 18px;background: url(img/quanqiugou.png) no-repeat right center;padding-left: 15px;}
			.intro{font-size: 12px;line-height: 22px;color: #666;margin-top:5px;}
			.pingjia{color: #a7a7a7;line-height: 30px;font-size: 12px;}
			.blue{color: #005aa0;}
			.footer{width:1200px;overflow: hidden;}
			.page{width: 680px;float: right;margin-top: 100px;height: 80px;}
			.page a{float: left;margin-right: 5px;line-height: 38px;color: #666;}
			#lastPage{border: 1px solid #C5C5C5;padding: 0 15px;height: 38px;color: #333;}
			.pageIndex{padding:0 15px;border: 1px solid #C5C5C5;font-size: 10px;color: #333;background: #f6f6f6;}
			#pageIndexActive{color: #ea703c;border: none;background: #fff;}
			#nextPage{border: 1px solid #C5C5C5;padding: 0 15px;height: 38px;color: #333;}
			#toPageIndex{float: left;width: 38px;line-height: 38px;border: 1px solid #C5C5C5;font-size: 10px;color: #333;text-align: center;}
			#submit{padding:0 15px;border: 1px solid #C5C5C5;font-size: 10px;color: #333;background: #f6f6f6;}
		</style>
	</head>
	<body>
		<div class="header">
			<img src="img/header.png" />
		</div>
		<ul id="picBox">
		</ul>
		<div class="footer">
			<p class="page">
				<a id="lastPage" href="#">&lt;上一页</a>
				<a class="pageIndex" id="pageIndexActive" href="#">1</a>
				<a class="pageIndex" href="#">2</a>
				<a class="pageIndex" href="#">3</a>
				<a class="pageIndex" href="#">4</a>
				<a class="pageIndex" href="#">5</a>
				<a id="nextPage" href="#">下一页&gt;</a>
				<a>&nbsp;&nbsp;共5页&nbsp;&nbsp;到第</a>
				<input type="text" id="toPageIndex" value="1">
				<a>&nbsp;&nbsp;页&nbsp;&nbsp;</a>
				<a href="#" id="submit">确认</a>
			</p>
		</div>
		<script>
			var ulList=document.getElementById("picBox");
			var indexList=document.getElementsByClassName("pageIndex");
			var lastPage=document.getElementById("lastPage");
			var nextPage=document.getElementById("nextPage");
			var toPageIndex=document.getElementById("toPageIndex");
			var oSubmit=document.getElementById("submit");
			var nowPage=1;
			ajaxUtil("get","data/jingdongData1.json",callBack);
			for(var i=0;i<indexList.length;i++){
				indexList[i].index=i;
				indexList[i].onclick=function(){
					nowPage=this.index+1;
					ajaxUtil("get","data/jingdongData"+(this.index+1)+".json",callBack);
					for(var j=0;j<indexList.length;j++){
						indexList[j].removeAttribute("id");
					}
					indexList[this.index].setAttribute("id","pageIndexActive");
					return false;
				}
			}
			lastPage.onclick=function(){
				nowPage--;
				if(nowPage<=0){
					nowPage=1;
				}else{
					ajaxUtil("get","data/jingdongData"+nowPage+".json",callBack);
				}
				for(var j=0;j<indexList.length;j++){
					indexList[j].removeAttribute("id");
				}
				indexList[nowPage-1].setAttribute("id","pageIndexActive");
				return false;
			}
			nextPage.onclick=function(){
				nowPage++;
				if(nowPage>=6){
					nowPage=5;
				}else{
					ajaxUtil("get","data/jingdongData"+nowPage+".json",callBack);
				}
				for(var j=0;j<indexList.length;j++){
					indexList[j].removeAttribute("id");
				}
				indexList[nowPage-1].setAttribute("id","pageIndexActive");
				return false;
			}
			oSubmit.onclick=function(){
				nowPage=toPageIndex.value;
				if(nowPage<=5&&nowPage>=1){
					ajaxUtil("get","data/jingdongData"+nowPage+".json",callBack);
					for(var j=0;j<indexList.length;j++){
						indexList[j].removeAttribute("id");
					}
					indexList[nowPage-1].setAttribute("id","pageIndexActive");
				}
				return false;
				
			}
			function ajaxUtil(method,url,fnCb){
		    	var xhr;
		        if(window.XMLHttpRequest){
		            xhr=new XMLHttpRequest();
		        }else{
		            xhr=new ActiveXObject("Microsoft.XMLHTTP");
		        }
		        xhr.onreadystatechange=function(){
		            if(xhr.readyState==4){
		                if(xhr.status==200){
		                    var result=xhr.responseText;//string
		                    //object;
		                    //var oData=JSON.parse(result); //
		                    if(fnCb){
		                    	fnCb(result);
		                    }
		                }else{
		                    alert("获取数据失败");
		                }
		            }
		        }
		        xhr.open(method,url,true);
		        xhr.send();
		    }
		    function callBack(result){
		    	var oData=eval("("+result+")");
		    	ulList.innerHTML="";
				for(var i=0;i<oData.length;i++){
					var li=document.createElement("li");
					var img=document.createElement("img");
					var price=document.createElement("p");
					var intro=document.createElement("p");
					var pingjia=document.createElement("p");
					img.src="img/"+oData[i].imgsrc;
					li.appendChild(img);
					price.setAttribute("class","price");
					price.innerHTML="￥"+oData[i].price;
					li.appendChild(price);
					intro.setAttribute("class","intro");
					intro.innerHTML=oData[i].info;
					li.appendChild(intro);
					pingjia.setAttribute("class","pingjia");
					pingjia.innerHTML="已有<span class=\"blue\">"+oData[i].pingjiaNum+"+</span>人评价";
					li.appendChild(pingjia);
					li.innerHTML+="<a href=\"#\"><img src=\"img/addTo.png\"/></a>"
					ulList.appendChild(li);
				}
		    }
		</script>
	</body>
</html>
