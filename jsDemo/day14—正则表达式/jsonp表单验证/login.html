<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>用户登录</title>
		<style>
			.box{width: 560px;height: 150px;background:#eee;margin: 0 auto;padding-left: 30px;}
			input{margin-top: 20px;margin-left: 30px;}
			#register{margin-left: 120px;margin-left: 150px;}
			span{font-size: 10px;padding-left: 10px;}
		</style>
	</head>
	<body>
		<div class="box">
			请输入用户名:<input type="text" id="name"/><span id="nameCheck"></span></span><br />
			请输入密码&nbsp;:<input type="password" id="pwd"/><span id="pwdCheck"></span><br />
			<input type="button" value="立即登录" id="login" />
		</div>
		
		<script>
			var oName=document.getElementById("name");
			var nameCheck=document.getElementById("nameCheck");
			var pwd=document.getElementById("pwd");
			var pwdCheck=document.getElementById("pwdCheck");
			var regPwd=new RegExp("^.{6,}$");
			var login=document.getElementById("login");
		
			oName.onblur=function(){
				var oScript=document.createElement("script");
				oScript.src="http://10.9.163.115:8081/user/CheckUserNameGet?username="+oName.value+"&callback=fnCheck";
				document.body.appendChild(oScript);
				oScript.onload=function(){
					this.parentNode.removeChild(this);
				}
			}
			function fnCheck(data){
				if(oName.value.trim()==""){
					nameCheck.innerHTML="用户名不能为空!";
					nameCheck.style.color="red";
				}
				else{
					if(data==1){
						nameCheck.innerHTML="用户名正确!";
						nameCheck.style.color="green";
					}
					else{
						nameCheck.innerHTML="用户名不存在!";
						nameCheck.style.color="red";
					}
				}
			}
			pwd.onblur=function(){
				if(pwd.value.trim()==""){
					pwdCheck.innerHTML="密码不能为空!";
					pwdCheck.style.color="red";
				}
				else{
					var result=regPwd.test(pwd.value.trim());
					if(result){
						pwdCheck.innerHTML="密码可用!";
						pwdCheck.style.color="green";
					}
					else{
						pwdCheck.innerHTML="密码长度太短,请输入6位及以上长度的密码!";
						pwdCheck.style.color="red";
					}
				}
			}
			login.onclick=function(){
				var oScript=document.createElement("script");
				oScript.src="http://10.9.163.115:8081/user/loginget?name="+oName.value+"&password="+pwd.value+"&callback=fn";
				document.body.appendChild(oScript);
				oScript.onload=function(){
					this.parentNode.removeChild(this);
				}
			}
			function fn(data){
				if(data==1){
					alert("登录成功!");
				}
				else{
					alert("登录失败!");
				}
			}
		</script>
	</body>
</html>
